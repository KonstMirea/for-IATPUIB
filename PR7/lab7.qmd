---
title: "Использование технологии Yandex Query для анализа данных сетевой активности"
subtitle: Отчёт по практике №7
author: "KTMUSIC22682@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель работы

1.  Изучить возможности технологии Yandex Query для анализа структурированных наборов данных
2.  Получить навыки построения аналитического пайплайна для анализа данных с помощью сервисов Yandex Cloud
3.  Закрепить практические навыки использования SQL для анализа данных сетевой активности в сегментированной корпоративной сети

## Исходные данные

1.  Программное обеспечение macOS Tahoe (26.0.1)
2.  RStudio
3.  Интерпретатор языка R 4.5.1

## Ход работы

### Создание соединения
![](screenshot/screenshot1.png)

### Привязка данных 
![](screenshot/screenshot2.png)

### Настройка привязки данных 
![](screenshot/screenshot3.png)

### Попытка сделать аналитический запрос
![](screenshot/screenshot4.png)

### Задание №1 - Известно, что IP адреса внутренней сети начинаются с октетов, принадлежащих интервалу [12-14]. Определите количество хостов внутренней сети, представленных в датасете.
```
SELECT
    COUNT(DISTINCT ip) AS hosts_count
FROM (
    SELECT src AS ip FROM `dataset-qyandex`
    UNION ALL
    SELECT dst AS ip FROM `dataset-qyandex`
) AS all_ips
WHERE
    CAST(String::SplitToList(ip, ".")[0] AS Uint32) BETWEEN 12 AND 14;
```

![](screenshot/screenshot5.png)

### Задание №2 - Определите суммарный объем исходящего трафика
```
SELECT
    SUM(CAST(bytes AS Uint64)) AS total_outgoing_bytes
FROM `dataset-qyandex`
WHERE
    CAST(String::SplitToList(src, ".")[0] AS Uint32) BETWEEN 12 AND 14;
```

![](screenshot/screenshot6.png)

### Задание №3 - Определите суммарный объем входящего трафика
```
SELECT
    SUM(CAST(bytes AS Uint64)) AS total_incoming_bytes
FROM `dataset-qyandex`
WHERE
    CAST(String::SplitToList(dst, ".")[0] AS Uint32) BETWEEN 12 AND 14;
```

![](screenshot/screenshot7.png)

## Оценка результатов
В результате анализа сетевого трафика было определено, что во внутренней сети (IP-адреса с первым октетом 12–14) находится 1000 уникальных хостов. Суммарный исходящий трафик составил 10007506588 байт, а входящий — 15740490053 байт, что позволяет оценить нагрузку на внутренние узлы. Диспропорция между объёмами входящего и исходящего трафика может указывать на преимущественно клиентский характер работы хостов.
## Вывод
Проведённый анализ подтвердил корректность фильтрации IP-адресов по заданному диапазону и позволил количественно оценить сетевую активность. Полученные метрики могут служить основой для планирования пропускной способности или выявления аномалий в трафике. Для более глубокого понимания сетевого поведения рекомендуется дополнительно проанализировать распределение трафика по портам и временным интервалам.
